<div
  [routerLink]="['/productDetails', cardItem._id]"
  class="relative group bg-white border border-gray-200 rounded-2xl shadow-md overflow-hidden cursor-pointer"
>
  <!-- Product Image -->
  <img
    class="p-6 h-56 w-full object-contain"
    [src]="cardItem.imageCover"
    alt="product image"
  />

  <!-- Wishlist Icon (Top Left) -->
<button
  (click)="$event.stopPropagation(); onWishlistClick(cardItem._id)"
  class="absolute top-3 left-3 z-20
         bg-white/90 backdrop-blur-md 
        
         transition-all duration-300 ease-in-out
         hover:scale-110 active:scale-95"
  aria-label="Add to wishlist"
>
  @if (isFAv()) {
   
    <i class="fa-solid fa-heart text-red-500 text-lg cursor-pointer"></i>
  }
  @else {
    <!-- Empty Heart when Not Favorited -->
    <i class="fa-regular fa-heart text-gray-400 hover:text-red-500 text-lg cursor-pointer"></i>
  }
</button>
  <!-- Add to Cart Icon (Top Right) -->
  <button
  [disabled]="isLoading()"
  (click)="$event.stopPropagation(); onAddToCartClick()"
  class="absolute top-3 right-3 
         md:-translate-y-10 md:opacity-0 
         md:group-hover:translate-y-0 md:group-hover:opacity-100
         transition-all duration-500 ease-in-out
         bg-green-600 hover:bg-green-700 text-white rounded-full p-3 shadow-lg
         focus:ring-4 focus:outline-none focus:ring-green-300 active:scale-95"
  aria-label="Add to cart"
>
  @if (isLoading()) {
    <span>Adding...</span>
    <i class="fa-solid fa-cart-shopping text-lg fa-bounce"></i>
  } @else {
    <i class="fa-solid fa-cart-shopping text-lg"></i>
  }
</button>


  <!-- Content -->
  <div class="px-6 pb-6 min-h-[200px] flex flex-col justify-between">
  <!-- Category -->
  <h5 class="text-xs font-semibold uppercase tracking-wider text-green-600 mb-1">
    {{ cardItem.category.name }}
  </h5>

  <!-- Product Title -->
  <h2 class="text-lg font-bold text-gray-900 line-clamp-2 transition-colors duration-300">
    {{ cardItem.title }}
  </h2>

  <!-- Price & Rating Section -->
  <div class="mt-4 flex flex-col gap-2">
    <!-- Price -->
    @if (cardItem.priceAfterDiscount){
    <div class="flex items-center gap-3">
      <!-- Discounted Price -->
      <span class="text-lg font-bold text-gray-900">
        {{ cardItem.priceAfterDiscount }} EGP
      </span>

      
      <span class="text-xs font-medium text-gray-400 line-through">
        {{ cardItem.price }} EGP
      </span>
       <span
      class=" text-red-800"
    >
      -{{ ((1 - (cardItem.priceAfterDiscount / cardItem.price)) * 100) | number:'1.0-0' }}% 
    </span>
    </div>


   
  }@else{
    <span class="text-xl font-bold text-gray-900">
      {{ cardItem.price }} EGP
    </span>
  }

    <!-- Rating -->
    <div class="flex items-center space-x-1 mt-1">
      <svg class="w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 22 20">
        <path
          d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z"
        />
      </svg>
     <span class="text-sm font-medium text-gray-500">{{ cardItem.ratingsAverage| number:'1.1-1' }}</span>
    </div>
  </div>
</div>

</div>
