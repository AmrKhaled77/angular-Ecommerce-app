<div class="overflow-hidden w-11/12 max-w-6xl mx-auto my-10 p-6 bg-white rounded-3xl shadow-xl relative ">

  <!-- Clear Cart Icon Top-Right -->
  @if (cartResponse() && cartResponse()!.data.products.length > 0) {
    <button 
      class="z-50 cursor-pointer absolute top-6 right-6 text-red-500 hover:text-red-700 text-2xl transition transform hover:scale-110"
      (click)="onClearCart()"
    >
      @if (isLoading()) {
        <i class="fa-solid fa-trash-can fa-bounce"></i>
      }
      @else {
        <i class="fa-solid fa-trash-can"></i>
      }
    </button>
  }


    <h1 class="text-5xl font-extrabold mb-12 text-gray-900 text-center animate-fade-in-up ">
    My cart
  </h1>

  <!-- Cart Items -->
  <div class="flex flex-col gap-6">

    <!-- حالة التحميل (Skeleton Loader) -->
    @if (loadingCart()) {
      @for (i of [1,2,3]; track i) {
        <div class="flex gap-4 items-center p-4 bg-white rounded-2xl shadow-md animate-pulse">
          <!-- صورة -->
          <div class="h-24 w-24 bg-gray-200 rounded-xl"></div>
          <!-- تفاصيل -->
          <div class="flex-1 space-y-3">
            <div class="h-4 w-2/3 bg-gray-200 rounded"></div>
            <div class="h-4 w-1/3 bg-gray-200 rounded"></div>
            <div class="h-4 w-1/4 bg-gray-200 rounded"></div>
          </div>
          <!-- زرار -->
          <div class="h-10 w-20 bg-gray-200 rounded"></div>
        </div>
      }
    }

    <!-- حالة وجود منتجات -->
    @else if (cartResponse() && cartResponse()!.data.products.length > 0) {
      @for (item of cartResponse()!.data.products; track $index) {
        <app-ui-cart-item 
          [routerLink]="['/productDetails', item.product.id]"
        
          [cartItem]="item" 
          [refreshCart]="showCart.bind(this,false)"
          [style.animation-delay]="`calc(0.03s * ${$index})`"
          class="animate-fade-in-up cursor-pointer ">
        </app-ui-cart-item>
      }
    }

    <!-- حالة فاضي -->
    @else {
      <div class="text-center py-20 text-gray-400 animate-fadeIn" id="empty-cart">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.3 6.5A1 1 0 007 21h10a1 1 0 001-.8L20.6 13M7 13H3"/>
        </svg>
        <p class="text-xl font-semibold">Your cart is empty</p>
        <p class="mt-2 text-gray-500">Start adding products to see them here.</p>
      </div>
    }

  </div>

  <!-- Total & Checkout -->
  @if (cartResponse() && cartResponse()!.data.products.length > 0) {
    <div class="flex flex-col md:flex-row justify-between items-center mt-8 p-6 bg-gray-100 rounded-2xl shadow-inner gap-4">
      <div class="text-gray-700 text-lg md:text-xl font-semibold">
        Total ({{cartResponse()!.numOfCartItems}} items): 
        <span class="text-green-600 text-2xl font-bold">
          {{cartResponse()!.data.totalCartPrice}} EGP
        </span>
      </div>

      <button
    [routerLink]="['/makeOrder', cartResponse()?.cartId]"
        class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-2xl font-semibold shadow-lg transition transform active:scale-95 flex items-center gap-2"
      >
        <i class="fa-solid fa-bag-shopping fa-lg"></i>
        Checkout
      </button>
    </div>
  }
</div>
